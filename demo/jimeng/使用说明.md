# å³æ¢¦è§†é¢‘ API ä½¿ç”¨è¯´æ˜

## ğŸ“¦ æ¨¡å—è¯´æ˜

å·²å°†å³æ¢¦è§†é¢‘ï¼ˆJimeng Videoï¼‰API å°è£…æˆç»“æ„åŒ–çš„ Python æ¨¡å—ã€‚

## âš ï¸ é‡è¦æç¤º

**æ­¤ API æ¯æ¬¡è°ƒç”¨éƒ½æœ‰è´¹ç”¨ï¼** ä½¿ç”¨å‰åŠ¡å¿…ï¼š
1. éªŒè¯è¯·æ±‚å‚æ•°
2. äº†è§£è®¡è´¹è§„åˆ™
3. å…ˆç”¨å°è§„æ¨¡æµ‹è¯•

## ğŸ“ æ–‡ä»¶ç»“æ„

```
jimeng/
â”œâ”€â”€ __init__.py              # æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ jimeng_client.py         # æ ¸å¿ƒå®¢æˆ·ç«¯ (ä¸»è¦ä»£ç )
â”œâ”€â”€ jimeng_examples.py       # ä½¿ç”¨ç¤ºä¾‹ (å¹²è·‘æ¨¡å¼)
â””â”€â”€ README.md                # è‹±æ–‡æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºç¡€ä½¿ç”¨

```python
from jimeng import JimengClient, create_simple_video_request

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = JimengClient(api_token="ä½ çš„token")

# åˆ›å»ºè¯·æ±‚
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="cat fish",
    aspect_ratio="16:9",
    size="1080P"
)

# éªŒè¯è¯·æ±‚ï¼ˆå¼ºçƒˆæ¨èï¼ï¼‰
is_valid, error = client.validate_request(request)
if is_valid:
    # å‘é€è¯·æ±‚ï¼ˆä¼šäº§ç”Ÿè´¹ç”¨ï¼‰
    response = client.generate_video(request)
    print(response)
else:
    print(f"è¯·æ±‚æ— æ•ˆ: {error}")
```

### 2. å¸¦å‚è€ƒå›¾ç‰‡

```python
from jimeng import create_video_with_images

request = create_video_with_images(
    model="jimeng-video-3.0",
    prompt="animate these images with smooth transitions",
    image_urls=[
        "https://example.com/image1.jpg",
        "https://example.com/image2.jpg"
    ],
    aspect_ratio="16:9",
    size="1080P"
)
```

### 3. ä¸åŒå®½é«˜æ¯”

```python
# ç«–å±
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="beautiful waterfall",
    aspect_ratio="9:16",  # ç«–å±
    size="1080P"
)

# æ­£æ–¹å½¢
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="abstract animation",
    aspect_ratio="1:1",   # æ­£æ–¹å½¢
    size="1080P"
)
```

### 4. ä¸åŒåˆ†è¾¨ç‡

```python
# æ ‡æ¸…ï¼ˆæˆæœ¬ä½ï¼‰
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="landscape",
    aspect_ratio="16:9",
    size="720P"   # æ ‡æ¸…
)

# é«˜æ¸…ï¼ˆé»˜è®¤ï¼‰
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="landscape",
    aspect_ratio="16:9",
    size="1080P"  # é«˜æ¸…
)
```

## ğŸ“– å‚æ•°è¯´æ˜

### å¿…éœ€å‚æ•°
- `model`: æ¨¡å‹åç§°ï¼ˆå¦‚ "jimeng-video-3.0"ï¼‰
- `prompt`: æ–‡æœ¬æç¤ºè¯

### å¯é€‰å‚æ•°
- `aspect_ratio`: å®½é«˜æ¯”ï¼ˆé»˜è®¤ "16:9"ï¼‰
  - `"16:9"`: å®½å±
  - `"9:16"`: ç«–å±
  - `"1:1"`: æ­£æ–¹å½¢
  - `"4:3"`: æ ‡å‡†
- `size`: åˆ†è¾¨ç‡ï¼ˆé»˜è®¤ "1080P"ï¼‰
  - `"720P"`: æ ‡æ¸…
  - `"1080P"`: é«˜æ¸…
- `images`: å‚è€ƒå›¾ç‰‡ URL åˆ—è¡¨

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: ç®€å•æ–‡ç”Ÿè§†é¢‘
```python
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="cat playing with yarn ball",
    aspect_ratio="16:9",
    size="1080P"
)
```

### åœºæ™¯ 2: ç«–å±çŸ­è§†é¢‘
```python
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="girl dancing",
    aspect_ratio="9:16",  # ç«–å±
    size="720P"          # èŠ‚çœæˆæœ¬
)
```

### åœºæ™¯ 3: å›¾ç‰‡åŠ¨ç”»åŒ–
```python
request = create_video_with_images(
    model="jimeng-video-3.0",
    prompt="smooth animation transition between images",
    image_urls=[
        "https://example.com/image1.jpg",
        "https://example.com/image2.jpg"
    ],
    aspect_ratio="16:9",
    size="1080P"
)
```

### åœºæ™¯ 4: æ‰¹é‡ç”Ÿæˆ
```python
prompts = [
    "cat playing",
    "dog running",
    "bird flying"
]

for prompt in prompts:
    request = create_simple_video_request(
        model="jimeng-video-3.0",
        prompt=prompt,
        aspect_ratio="16:9",
        size="720P"  # èŠ‚çœæˆæœ¬
    )

    is_valid, error = client.validate_request(request)
    if is_valid:
        response = client.generate_video(request)
        print(f"ç”ŸæˆæˆåŠŸ: {prompt}")
```

## ğŸ” å‚æ•°éªŒè¯

ä½¿ç”¨å‰åŠ¡å¿…éªŒè¯ï¼š

```python
is_valid, error = client.validate_request(request)
if not is_valid:
    print(f"è¯·æ±‚æ— æ•ˆ: {error}")
    return

# å®‰å…¨å‘é€
response = client.generate_video(request)
```

### éªŒè¯æ£€æŸ¥é¡¹
- âœ“ å¿…éœ€å­—æ®µå­˜åœ¨
- âœ“ aspect_ratio åœ¨æœ‰æ•ˆå€¼ä¸­
- âœ“ size åœ¨æœ‰æ•ˆå€¼ä¸­
- âœ“ prompt ä¸ä¸ºç©º

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é¢„è§ˆè¯·æ±‚å†…å®¹
```python
# æŸ¥çœ‹å°†è¦å‘é€çš„å†…å®¹
print(request.to_json())
```

### 2. ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨ Token
```python
import os
from jimeng import JimengClient

token = os.getenv("JIMENG_API_TOKEN")
client = JimengClient(api_token=token)
```

### 3. é”™è¯¯å¤„ç†
```python
try:
    response = client.generate_video(request)
    print(f"æˆåŠŸ: {response}")
except Exception as e:
    print(f"API é”™è¯¯: {e}")
```

## ğŸ” æŸ¥è¯¢è§†é¢‘çŠ¶æ€

### æŸ¥è¯¢æ¥å£

```python
from jimeng import JimengClient

client = JimengClient(api_token="ä½ çš„token")

# æŸ¥è¯¢è§†é¢‘çŠ¶æ€
response = client.query_video("jimeng:7391ad0e-9813-48ba-a742-ed0720e44e45")
status = response["data"]["status"]  # processing, completed, failed

print(f"çŠ¶æ€: {status}")
if status == "completed":
    print(f"è§†é¢‘URL: {response['data']['video_url']}")
```

### ç­‰å¾…å®Œæˆ

```python
from jimeng import JimengClient, wait_for_video_completion

client = JimengClient(api_token="ä½ çš„token")

# è½®è¯¢ç›´åˆ°å®Œæˆ
result = wait_for_video_completion(
    client,
    video_id,
    timeout=600,      # æœ€å¤šç­‰å¾… 10 åˆ†é’Ÿ
    poll_interval=10   # æ¯ 10 ç§’æ£€æŸ¥ä¸€æ¬¡
)

print(f"âœ“ è§†é¢‘å®Œæˆ: {result['data']['video_url']}")
```

### æŸ¥è¯¢çŠ¶æ€å€¼

- `processing`: å¤„ç†ä¸­ï¼ˆè§†é¢‘æ­£åœ¨ç”Ÿæˆï¼‰
- `completed`: å®Œæˆï¼ˆè§†é¢‘å·²ç”Ÿæˆï¼Œå¯ä¸‹è½½ï¼‰
- `failed`: å¤±è´¥ï¼ˆç”Ÿæˆå¤±è´¥ï¼ŒæŸ¥çœ‹ error å­—æ®µï¼‰

## ğŸ§ª æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•
```bash
python3 -m jimeng.test_jimeng
```

### è¿è¡Œç”Ÿæˆç¤ºä¾‹ï¼ˆå¹²è·‘æ¨¡å¼ï¼Œä¸äº§ç”Ÿè´¹ç”¨ï¼‰
```bash
python3 -m jimeng.jimeng_examples
```

### è¿è¡ŒæŸ¥è¯¢ç¤ºä¾‹ï¼ˆå¹²è·‘æ¨¡å¼ï¼Œä¸äº§ç”Ÿè´¹ç”¨ï¼‰
```bash
python3 -m jimeng.query_examples
```

## ğŸ“Š å®é™… Payload æ ¼å¼

å°è£…ç”Ÿæˆçš„ JSON æ ¼å¼ï¼š

```json
{
  "model": "jimeng-video-3.0",
  "prompt": "cat fish",
  "aspect_ratio": "16:9",
  "size": "1080P",
  "images": []
}
```

## ğŸ’° æˆæœ¬æ§åˆ¶å»ºè®®

1. **ä¼˜å…ˆä½¿ç”¨ 720P**
   ```python
   size="720P"  # æˆæœ¬ä½ï¼Œæ•ˆæœä¹Ÿä¸é”™
   ```

2. **éªŒè¯åå†å‘é€**
   ```python
   is_valid, error = client.validate_request(request)
   if not is_valid:
       return  # é¿å…æ— æ•ˆè¯·æ±‚äº§ç”Ÿè´¹ç”¨
   ```

3. **è®°å½•æ‰€æœ‰è¯·æ±‚**
   ```python
   import logging
   logging.info(f"Sending: {request.to_dict()}")
   response = client.generate_video(request)
   logging.info(f"Response: {response}")
   ```

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¸è¦æäº¤ Token åˆ°ç‰ˆæœ¬æ§åˆ¶**
   ```bash
   # .env.local
   JIMENG_API_TOKEN=your-token-here
   ```

2. **ä½¿ç”¨ç¯å¢ƒå˜é‡**
   ```python
   import os
   token = os.getenv("JIMENG_API_TOKEN")
   ```

3. **éªŒè¯ç”¨æˆ·è¾“å…¥**
   ```python
   # éªŒè¯ prompt å†…å®¹
   if not prompt or len(prompt) > 500:
       raise ValueError("Invalid prompt")
   ```

## ğŸ› å¸¸è§é—®é¢˜

### Q: aspect_ratio å€¼æ— æ•ˆ
```python
# é”™è¯¯
aspect_ratio="21:9"  # ä¸æ”¯æŒ

# æ­£ç¡®
aspect_ratio="16:9"  # æˆ– 9:16, 1:1, 4:3
```

### Q: size å€¼æ— æ•ˆ
```python
# é”™è¯¯
size="4K"  # ä¸æ”¯æŒ

# æ­£ç¡®
size="1080P"  # æˆ– "720P"
```

### Q: ç¼ºå°‘å¿…éœ€å­—æ®µ
```python
# é”™è¯¯
request = JimengVideoRequest(model="jimeng-video-3.0")  # ç¼ºå°‘ prompt

# æ­£ç¡®
request = JimengVideoRequest(
    model="jimeng-video-3.0",
    prompt="cat fish"
)
```

## ğŸ“ å®Œæ•´ç¤ºä¾‹

```python
import os
from jimeng import JimengClient, create_simple_video_request

# 1. ä»ç¯å¢ƒå˜é‡è·å– token
token = os.getenv("JIMENG_API_TOKEN")
if not token:
    raise ValueError("è¯·è®¾ç½® JIMENG_API_TOKEN ç¯å¢ƒå˜é‡")

# 2. åˆå§‹åŒ–å®¢æˆ·ç«¯
client = JimengClient(api_token=token)

# 3. åˆ›å»ºè¯·æ±‚
request = create_simple_video_request(
    model="jimeng-video-3.0",
    prompt="beautiful sunset over mountain",
    aspect_ratio="16:9",
    size="720P"
)

# 4. é¢„è§ˆè¯·æ±‚
print("è¯·æ±‚å†…å®¹:")
print(request.to_json())

# 5. éªŒè¯è¯·æ±‚
is_valid, error = client.validate_request(request)
if not is_valid:
    print(f"âŒ è¯·æ±‚æ— æ•ˆ: {error}")
    exit(1)

print("âœ“ è¯·æ±‚éªŒè¯é€šè¿‡")

# 6. ç¡®è®¤å‘é€ï¼ˆå› ä¸ºä¼šäº§ç”Ÿè´¹ç”¨ï¼‰
confirm = input("ç¡®è®¤å‘é€è¯·æ±‚ï¼Ÿ(yes/no): ")
if confirm.lower() != "yes":
    print("å·²å–æ¶ˆ")
    exit(0)

# 7. å‘é€è¯·æ±‚
try:
    response = client.generate_video(request)
    print(f"âœ“ æˆåŠŸ: {response}")
except Exception as e:
    print(f"âŒ é”™è¯¯: {e}")
```

## ğŸ‰ æ€»ç»“

âœ… å®Œæ•´å°è£…å³æ¢¦è§†é¢‘ API
âœ… ç±»å‹å®‰å…¨çš„æ•°æ®ç»“æ„
âœ… å‚æ•°éªŒè¯
âœ… è¾…åŠ©å‡½æ•°
âœ… è¯¦ç»†æ–‡æ¡£
âœ… å¹²è·‘æ¨¡å¼ç¤ºä¾‹

ç°åœ¨å¯ä»¥å®‰å…¨ã€æ–¹ä¾¿åœ°ä½¿ç”¨å³æ¢¦è§†é¢‘ API äº†ï¼
